<!DOCTYPE html>
<html lang="en">
<head>
        <title>frozen - x86_64</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href=".././theme/css/main.css" type="text/css" />
        <link href="/frozen/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="frozen Atom Feed" />
        

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie.css"/>
                <script src=".././js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">

        <header id="banner" class="body">
                <h1><a href="../.">frozen </a></h1>
                <nav><ul>
                
                
                
                
                
                    <li ><a href=".././category/misc.html">misc</a></li>
                
                </ul></nav>
        </header><!-- /#banner -->
                

            

        
        
            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href=".././building-distributed-data-processing-pipeline.html">Building distributed data processing pipeline</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2012-02-21T00:00:00">
                Tue 21 February 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/x86_64.html">x86_64</a>
        </address>
        
<p>In <a href=".././category/misc.html">misc</a>. </p>



</footer><!-- /.post-info --><p>Then we try to process huge amount of data it nearly always results in building complex and hardly maintainable
systems with all sort of tools in it: starting with split + rsync files between computers and ending with hardcore scripts on
all possible languages. Recently some problems were solved, including appearance of ZeroMQ which really helps. But you still can not
jump on to problem and solve it quickly, it always require to spend some time to prepare, build blocks and only then solve actual problems.
Frozen try to fill this gap and provide these blocks. Lets see how we can build something distributed.</p>
<h2 id="goal">Goal</h2>
<p>Lets took something simple and move to more complex things. Assume we have huge file with data represented as lines in it. We want to
split it in several groups and for each group we have own special handler.</p>
<h2 id="step_1_read_data">Step 1: read data</h2>
<p>To read data we use following config:
<a href="https://github.com/x86-64/frozen/blob/master/examples/article_dist_source.m4">article_dist_source.m4</a></p>
<p>We just read data from file, next we split it in lines and send using zeromq to workers pool. We do not bother with doing it fast right here
because we do not need to. If you have huge data, you possibly have huge cluster to process it, and very likely you have distributed fs on
it. Every cluster configuration have it's own advantages and disadvantages. Maybe you have several data storage servers and they are very good
at reading speed, but maybe you have common hardware with low readwrite speed on hdd. In any case you should consider best approach for your
cluster and use it. We can start as many readers with as many files as we want, because zeromq allow us to join this flows to be merged into
one.</p>
<h2 id="step_2_categorize_data">Step 2: categorize data</h2>
<p>At first, we create dummy worker, it only print our data and we ensure that everything is ok.
<a href="https://github.com/x86-64/frozen/blob/master/examples/article_dist_worker.m4">article_dist_worker.m4</a></p>
<p>Next step is to decide - which data where to go. Lets to in straightforward for now with [mod_machine_regexp.][]
<a href="https://github.com/x86-64/frozen/blob/master/examples/article_dist_worker_reg.m4">article_dist_worker_reg.m4</a></p>
<p>Here we grep data with "dhcp" in it and send to another process. See both <a href="../static/doxygen/group__mod__machine__regexp.html">mod_machine_regexp</a>, 
<a href="../static/doxygen/group__mod__machine__switch.html">mod_machine_switch</a> for more complex examples.</p>
<h2 id="step_3_save_results">Step 3: save results</h2>
<p>After processing we want to save results, lets save it to simple file.
<a href="https://github.com/x86-64/frozen/blob/master/examples/article_dist_destination.m4">article_dist_destination.m4</a></p>
<h2 id="testing">Testing</h2>
<p>As you can notice, all zeromq adresses is local, so we definitely need to start it on local machine, but it will work on cluster
when you change addresses to correct one.</p>
<div class="codehilite"><pre>$ <span class="n">frozend</span> <span class="o">-</span><span class="n">c</span> <span class="n">examples</span><span class="o">/</span><span class="n">article_dist_destination</span><span class="p">.</span><span class="n">m4</span>

$ <span class="n">frozend</span> <span class="o">-</span><span class="n">c</span> <span class="n">examples</span><span class="o">/</span><span class="n">article_dist_worker_reg</span><span class="p">.</span><span class="n">m4</span>

$ <span class="n">frozend</span> <span class="o">-</span><span class="n">c</span> <span class="n">examples</span><span class="o">/</span><span class="n">article_dist_source</span><span class="p">.</span><span class="n">m4</span>
</pre></div>


<p>Then source finish reading, we could see in worker console grepped data and destination worker wrote data to file too.</p>
<h2 id="possible_improvements">Possible improvements</h2>
<p>That was easy, but not so useful. Here how we can improve things:</p>
<ul>
<li> Problem: hardcoded addresses. Solutions:
<ul>
<li>As you can notice config file is m4 script, you can make include file with addresses, or join all files into one and use
ifdef and roles supplied from command line</li>
<li>You can pass zeromq socket to remote machine. And remote machine use this socket to return data, or send it to another stage</li>
</ul>
</li>
<li>
Problem: hardcoded categorization and complex config file. Solutions:
<ul>
<li>It is still m4 file - use define() to describe common categorization rule, and just put MY_RULE(`dhcp', `tcp://somehost:12345') as many
as you need.</li>
<li>You can pass parameters and rules for worker at same time with data. Don't know there it can be used, but you can.</li>
</ul>
</li>
<li>Problem: not flexible processing. Solutions: if you have some very complex processing requirements, write module by yourself -
it is just zeromq messages with clean data flowing around. Pick your favorite language and process as you like, return to frozen if need.</li>
</ul>
                </article>
                
            </aside><!-- /#featured -->
            
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
            
        
        
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././destination-irrelevant-architecture.html" rel="bookmark"
                           title="Permalink to Destination-irrelevant architecture">Destination-irrelevant architecture</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-03-16T00:00:00">
                Fri 16 March 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/x86_64.html">x86_64</a>
        </address>
        
<p>In <a href=".././category/misc.html">misc</a>. </p>



</footer><!-- /.post-info -->
                <p>Today many developers use request-based in everything - it is very easy to think in it, easy to understand, easy to use.
But that happens next? Next we want to do things fast. Here we go for multi threaded program, event-driven programming, use co-routines,
and every single bit we can find ...</p>
                <a class="readmore" href=".././destination-irrelevant-architecture.html">read more</a>
                
                </div><!-- /.entry-content -->
            </article></li>
        
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././flow-based-programming-intro.html" rel="bookmark"
                           title="Permalink to Flow-based programming intro">Flow-based programming intro</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-02-17T00:00:00">
                Fri 17 February 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/x86_64.html">x86_64</a>
        </address>
        
<p>In <a href=".././category/misc.html">misc</a>. </p>



</footer><!-- /.post-info -->
                <h3 id="copying_files_in_simple_way">Copying files in simple way</h3>
<p>What could be simplier than to copy file? May be this is not very interesting way to spend your time, but lets take a look
how we can do job using frozen and it's flow-based nature. First, assume we want to copy file within ...</p>
                <a class="readmore" href=".././flow-based-programming-intro.html">read more</a>
                
                </div><!-- /.entry-content -->
            </article></li>
        
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href=".././remote-data-access-with-zeromq-proxies.html" rel="bookmark"
                           title="Permalink to Remote data access with ZeroMQ proxies">Remote data access with ZeroMQ proxies</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-12-05T00:00:00">
                Wed 05 December 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/x86_64.html">x86_64</a>
        </address>
        
<p>In <a href=".././category/misc.html">misc</a>. </p>



</footer><!-- /.post-info -->
                <p>Now with ZeroMQ data proxy we can access remote data which hosted in another frozen instance in same way
as it could be inside same process.
It looks like:</p>
<p><a href="https://github.com/x86-64/frozen/blob/master/examples/data_zeromq_proxy_t.fz">data_zeromq_proxy_t.fz</a></p>
<p>Here is "client" variable represent remote data. And "server" is data on remote server. For testing purpose it was ...</p>
                <a class="readmore" href=".././remote-data-access-with-zeromq-proxies.html">read more</a>
                
                </div><!-- /.entry-content -->
            </article></li>
        
        
            
<p class="paginator">
    
    Page 1 / 1
    
</p>

        
        
            </ol><!-- /#posts-list -->
            </section><!-- /#content -->
        
    


        <section id="extras" class="body">
        
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                        
                            <li><a href="http://x86-64.github.com/frozen/wiki/html/">Main project page</a></li>
                        
                            <li><a href="http://x86-64.github.com/frozen/doxygen/">Doxygen files</a></li>
                        
                            <li><a href="http://groups.google.com/group/frozend">Discussion group</a></li>
                        
                        </ul>
                </div><!-- /.blogroll -->
        
        
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-7806052-2");
    pageTracker._trackPageview();
    } catch(err) {}</script>



</body>
</html>